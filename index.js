  const products = [
    {
      "id": 1,
      "product_name": "REDMI A3X (Midnight Black, 128 GB)",
      "image": "./images/-original-imah2hfpxtwagduh.jpeg",
      "price": {
        "current_price": "₹6,499",
        "original_price": "₹10,999",
        "discount_percentage": "40% off"
      },
      "rating": {
        "score": 4.1,
        "total_ratings": "7,529 Ratings",
        "total_reviews": "311 Reviews"
      },
      "specifications": {
        "ram": "4 GB RAM | 128 GB ROM",
        "storage_expandable": "Expandable Upto 1 TB",
        "display": "17.04 cm (6.71 inch) HD+ Display",
        "rear_camera": "8MP Rear Camera | 5MP Front Camera",
        "battery": "5000 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Manufacturer Warranty for Phone and \n 6 Months Warranty For in the Box Accessories",
      },
      "offers": {
        "exchange_offer": "Upto <b>₹4,350</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 2,
      "product_name": "REDMI A5 (Jaisalmer Gold, 128GB)",
      "image": "./images/redmi.webp",
      "price": {
        "current_price": "₹7,499",
        "original_price": "₹9,999",
        "discount_percentage": "25% off"
      },
      "rating": {
        "score": 4.2,
        "total_ratings": "2,647 Ratings",
        "total_reviews": "148 Reviews"
      },
      "specifications": {
        "ram": "4 GB RAM | 128 GB ROM",
        "storage_expandable": "Expandable Upto 2 TB",
        "display": "17.48 cm (6.88 inch) HD+ Display",
        "rear_camera": "32MP Rear Camera | 8MP Front Camera",
        "battery": "5200 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Manufacturer Warranty and 6 Months Warranty for In the Box Accessories"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹5,100</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 3,
      "product_name": "Nokia 105 Single SIM, Keypad Mobile Phone",
      "image": "./images/105-single-sim-keypad-mobile-phone-with-wireless-fm-radio-ta.jpeg",
      "price": {
        "current_price": "₹939",
        "original_price": "₹1,599",
        "discount_percentage": "41% off"
      },
      "rating": {
        "score": 4.1,
        "total_ratings": "1,71,013 Ratings",
        "total_reviews": "10,902 Reviews"
      },
      "specifications": {
        "ram": "4 MB RAM | 10 MB ROM",
        "display": "3.86 cm (1.52 inch) Display",
        "battery": "800 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Manufacturer Warranty on Handset & 6 Months Warranty on Accessories"
      },
      "offers": {
        "phones_left": "Only 1 left",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 4,
      "product_name": "Motorola g45 5G (Brilliant Blue, 128 GB)",
      "image": "./images/-original-imah3xk892aj9gck.jpeg",
      "product_price": {
        "current_price": "₹11,999",
        "original_price": "₹14,999",
        "discount_percentage": "20% off"
      },
      "rating": {
        "score": 4.3,
        "total_ratings": "2,13,881 Ratings",
        "total_reviews": "10,880 Reviews"
      },
      "specifications": {
        "ram": "8 GB RAM | 128 GB ROM",
        "storage_expandable": "Expandable Upto 1 TB",
        "display": "16.51 cm (6.5 inch) HD+ Display",
        "rear_camera": "50MP + 2MP | 16MP Front Camera",
        "battery": "5000 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Warranty on Handset and 6 Months Warranty for In the Box Accessories"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹8,350</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 5,
      "product_name": "Samsung Galaxy F05 (Twilight Blue, 64 GB)",
      "image": "./images/-original-imah56hkgehywn5b.jpeg",
      "product_price": {
        "current_price": "₹6,249",
        "original_price": "₹9,999",
        "discount_percentage": "37% off"
      },
      "rating": {
        "score": 4.2,
        "total_ratings": "11,399 Ratings",
        "total_reviews": "488 Reviews"
      },
      "specifications": {
        "ram": "4 GB RAM| 64 GB ROM",
        "storage_expandable": "Expandable Upto 1 TB",
        "display": "17.12 cm (6.74 inch) HD+ Display",
        "rear_camera": "50MP + 2MP | 8MP Front Camera",
        "battery": "5000 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Manufacturer Warranty and 6 Months Warranty for In-Box Accessories"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹4,150</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 6,
      "product_name": "realme Narzo 80 Lite 4G (Beach Gold, 64 GB)",
      "image": "./images/narzo-80-lite-4g-rmx5313-realme-original-imahegxgdvbva7zf.jpeg",
      "product_price": {
        "current_price": "₹7,233",
        "original_price": "₹8,999",
        "discount_percentage": "19% off"
      },
      "rating": {
        "score": 4.3,
        "total_ratings": "11,399 Ratings",
        "total_reviews": "488 Reviews"
      },
      "specifications": {
        "ram": "4 GB RAM | 64 GB ROM",
        "display": "17.12 cm (6.74 inch) HD+ Display",
        "rear_camera": "13MP Rear Camera",
        "battery": "6300 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year brand Warranty"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹3,950</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 7,
      "product_name": "POCO C71 (Power Black, 128 GB)",
      "image": "./images/-original-imahawgahmkbjxyj.jpeg",
      "product_price": {
        "current_price": "₹6,999",
        "original_price": "₹9,999",
        "discount_percentage": "30% off"
      },
      "rating": {
        "score": 4.1,
        "total_ratings": "14,636 Ratings",
        "total_reviews": "721 Reviews"
      },
      "specifications": {
        "ram": "6 GB RAM | 128 GB ROM",
        "storage_expandable": "Expandable Upto 2 TB",
        "display": "17.48 cm (6.88 inch) HD+ Display",
        "rear_camera": "32MP Rear Camera | 8MP Front Camera",
        "battery": "5200 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Manufacturer Warranty and 6 Months Warranty for In the Box Accessories"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹4,700</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 8,
      "product_name": "realme 15 Pro 5G(Flowing Silver, 256 GB)",
      "image": "./images/vicky.webp",
      "product_price": {
        "current_price": "₹33,999",
        "original_price": "₹37,999",
        "discount_percentage": "10% off"
      },
      "rating": {
        "score": 4.3,
        "total_ratings": "4,888 Ratings",
        "total_reviews": "446 Reviews"
      },
      "specifications": {
        "ram": "8 GB RAM | 256 GB ROM",
        "display": "17.27 cm (6.8 inch) Display",
        "rear_camera": "50MP + 50MP | 50MP Front Camera",
        "battery": "7000 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Manufacturer Warranty and 6 Months Warranty for In the Box Accessories"
      },
      "offers": {
        "phones_left": "Only 1 left",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 9,
      "product_name": "vivo T4 5G (Phantom Grey, 128 GB)",
      "image": "./images/vivo.webp",
      "product_price": {
        "current_price": "₹20,999",
        "original_price": "₹25,999",
        "discount_percentage": "19% off"
      },
      "rating": {
        "score": 4.5,
        "total_ratings": "70,252 Ratings",
        "total_reviews": "3,204 Reviews"
      },
      "specifications": {
        "ram": "8 GB RAM | 128 GB ROM",
        "storage_expandable": "Expandable Upto 2 TB",
        "display": "17.28 cm (6.77 inch) HD+ Display",
        "rear_camera": "50MP (OIS) + 2MP | 32MP Front Camera",
        "battery": "7300 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Manufacturer Warranty and 6 Months Warranty for In the Box Accessories"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹16,100</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 10,
      "product_name": "REDMI A5 (Just Black, 64 GB)",
      "image": "./images/-original-imahb56zdgszp7tg.jpeg",
      "product_price": {
        "current_price": "₹6,499",
        "original_price": "₹8,999",
        "discount_percentage": "27% off"
      },
      "rating": {
        "score": 4.2,
        "total_ratings": "3,267 Ratings",
        "total_reviews": "149 Reviews"
      },
      "specifications": {
        "ram": "3 GB RAM | 64 GB ROM",
        "storage_expandable": "Expandable Upto 2 TB",
        "display": "17.48 cm (6.88 inch) HD+ Display",
        "rear_camera": "32MP Rear Camera | 8MP Front Camera",
        "battery": "5200 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Manufacturer Warranty and 6 Months Warranty for In the Box Accessories"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹4,350</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 11,
      "product_name": "POCO C75 5G (Aqua Bliss, 64 GB)",
      "image": "./images/-original-imahbr2cz5apcwze (1).jpeg",
      "product_price": {
        "current_price": "₹7,699",
        "original_price": "₹10,999",
        "discount_percentage": "30% off"
      },
      "rating": {
        "score": 4.2,
        "total_ratings": "1,03,254 Ratings",
        "total_reviews": "4,829 Reviews"
      },
      "specifications": {
        "ram": "3 GB RAM | 64 GB ROM",
        "storage_expandable": "Expandable Upto 1 TB",
        "display": "17.48 cm (6.88 inch) HD+ Display",
        "rear_camera": "50MP Rear Camera | 5MP Front Camera",
        "battery": "5160 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Manufacturer Warranty and 6 Months Warranty for In the Box Accessories"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹5200</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 12,
      "product_name": "Samsung Guru Music 2 B310ED",
      "image": "./images/guru-music-2-b310ed-guru-music-2-samsung-original-imahfyupkv.jpeg",
      "product_price": {
        "current_price": "₹898",
        "original_price": "₹1,999",
        "discount_percentage": "55% off"
      },
      "rating": {
        "score": 3.1,
        "total_ratings": "24,038 Ratings",
        "total_reviews": "1,689 Reviews"
      },
      "specifications": {
        "ram": "32 MB RAM | 32 MB ROM",
        "storage_expandable": "Expandable Upto 100 MB",
        "display": "4.57 cm (1.8 inch) VGA Display",
        "rear_camera": "0MP Rear Camera | 0MP Front Camera",
        "battery": "800 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Seller Warranty"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹3,950</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 13,
      "product_name": "HOTLINE TURTLE",
      "image": "./images/classic-turtle-classic-turtle-hotline-original-imahb9gz8jgyn.jpeg",
      "product_price": {
        "current_price": "₹699",
        "original_price": "₹999",
        "discount_percentage": "30% off"
      },
      "rating": {
        "score": 3.7,
        "total_ratings": "376 Ratings",
        "total_reviews": "27 Reviews"
      },
      "specifications": {
        "ram": "32 MB RAM | 32 MB ROM",
        "storage_expandable": "Expandable Upto 16 GB",
        "display": "4.57 cm (1.8 inch) NA Display",
        "rear_camera": "1.3MP + 0MP Rear Camera | 0MP Front Camera",
        "battery": "1100 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "3 Months domestic Warranty"
      },
      "offers": {
        "phones_left": "Only 1 left",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 14,
      "product_name": "Samsung Galaxy S25 Ultra",
      "image": "./images/ultra.webp",
      "product_price": {
        "current_price": "₹1,19,999",
        "original_price": "₹1,29,999",
        "discount_percentage": "7% off"
      },
      "rating": {
        "score": 4.7,
        "total_ratings": "2,012 Ratings",
        "total_reviews": "222 Reviews"
      },
      "specifications": {
        "ram": "12 GB RAM | 256 GB ROM",
        "storage_expandable": "Expandable Upto 1 TB",
        "display": "17.53 cm (6.9 inch) Quad HD+ Display",
        "rear_camera": "200MP + 50MP + 50MP + 10MP Rear Camera",
        "front_camera": "12MP Front Camera",
        "battery": "5000 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Manufacturer Warranty and 6 Months Warranty for In the Box Accessories"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹41,350</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 15,
      "product_name": "MOTOROLA g35 5G (Midnight Black, 128 GB)",
      "image": "./images/g35-5g-pb3h0000in-motorola-original-imah7c6ykgz5rtgv.jpeg",
      "product_price": {
        "current_price": "₹8,999",
        "original_price": "₹12,499",
        "discount_percentage": "28% off"
      },
      "rating": {
        "score": 4.2,
        "total_ratings": "75,633 Ratings",
        "total_reviews": "5,241 Reviews"
      },
      "specifications": {
        "ram": "4 GB RAM | 128 GB ROM",
        "storage_expandable": "Expandable Upto 1 TB",
        "display": "17.07 cm (6.72 inch) Full HD+ Display",
        "rear_camera": "50MP + 8MP Rear Camera",
        "front_camera": "16MP Front Camera",
        "battery": "5000 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Manufacturer Warranty and 6 Months Warranty for In the Box Accessories"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹6,150</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    },
    {
      "id": 16,
      "product_name": "Google Pixel 10 (Indigo, 256 GB)",
      "image": "./images/google.webp",
      "product_price": {
        "current_price": "₹79,999",
        "original_price": "₹1,10,999",
        "discount_percentage": "40% off"
      },
      "rating": {
        "score": 4.4,
        "total_ratings": "549 Ratings",
        "total_reviews": "52 Reviews"
      },
      "specifications": {
        "ram": "12 GB RAM | 256 GB ROM",
        "storage_expandable": "Expandable Upto 1 TB",
        "display": "16.0 cm (6.3 inch) HD+ Display",
        "rear_camera": "48MP + 13MP | 10.5MP Front Camera",
        "battery": "4970 mAh Battery"
      },
      "warranty": {
        "phone_warranty": "1 Year Domestic Warranty"
      },
      "offers": {
        "exchange_offer": "Upto <b>₹53,650</b> Off on Exchange",
        "bank_offer": "Bank Offer"
      }
    }
  ];

  document.addEventListener("DOMContentLoaded", () => {
  const productList = document.querySelector(".product-results");
  const searchInput = document.querySelector(".search-bar input");
  const sortLinks = document.querySelectorAll(".sort-link");
  const minPriceSelect = document.querySelector(".min-select");
  const maxPriceSelect = document.querySelector(".max-select");

  const brandCheckboxes = document.querySelectorAll(".brand-filter input[type='checkbox']");
  const ramCheckboxes = document.querySelectorAll(".ram-filter input[type='checkbox']");
  const storageCheckboxes = document.querySelectorAll(".storage-filter input[type='checkbox']");
  const batteryCheckboxes = document.querySelectorAll(".battery-filter input[type='checkbox']");
  const screenCheckboxes = document.querySelectorAll(".screen-filter input[type='checkbox']");
  const ratingCheckboxes = document.querySelectorAll(".rating-filter input[type='checkbox']");
  const primaryCameraCheckboxes = document.querySelectorAll(".primary-filter input[type='checkbox']");
  const secondaryCameraCheckboxes = document.querySelectorAll(".secondary-filter input[type='checkbox']");
  const selectedFiltersBox = document.querySelector("#selectedFiltersBox");

  const filterTagsContainer = document.createElement("div");
  filterTagsContainer.className = "selected-filters-container hidden"; // hidden initially
  filterTagsContainer.style.cssText = `
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    padding:8px 10px;
    margin:10px 0;
    align-items:center;
    font-size:13px;
    box-shadow:none;
    background:none;
    border:none;
    transition: all 0.25s ease-in-out;
  `;

  const clearAllBtn = document.createElement("button");
  clearAllBtn.textContent = "CLEAR ALL";
  clearAllBtn.style.cssText = `
    background:#fff;
    color:#2874f0;
    border:none;
    padding:4px 8px;
    border-radius:3px;
    font-size:12px;
    font-weight: bold;
    cursor:pointer;
    margin-left:auto;
    display:none;
  `;

  filterTagsContainer.appendChild(clearAllBtn);
  selectedFiltersBox.appendChild(filterTagsContainer);

  let filteredProducts = [...products];

  const extractPrice = (p) =>
    parseInt((p.price?.current_price || p.product_price?.current_price).replace(/[^0-9]/g, ""));

  const renderProducts = (data) => {
    const html = data.map((product) => {
  
      const price = product.price || product.product_price || {}; 
      const specsList = product.specifications
        ? Object.values(product.specifications)
            .map((v) => `<li>${v}</li>`)
            .join("")
        : "";
      const mainOffer = product.offers?.exchange_offer || "";
      return `
        <div class="product-card">
          <div class="product-image"> 
            <div class="wishlist-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 16">
                <path d="M8.695 16.682C4.06 12.382 1 9.536 1 6.065 1 3.219 3.178 1 5.95 1c1.566 0 3.069.746 4.05 1.915C10.981 1.745 12.484 1 14.05 1 16.822 1 19 3.22 19 6.065c0 3.471-3.06 6.316-7.695 10.617L10 17.897l-1.305-1.215z" fill="#C7C7C7" stroke="#FFF"></path>
              </svg>
            </div>
            <img src="${product.image}" alt="${product.product_name}">
            <div class="compare-checkbox-container">
              <label class="compare">
                <input type="checkbox" class="compare-checkbox" data-product-id="${product.id}">
              </label>    
              <label class="compare-text"><span>Add to Compare</span></label>
            </div>  
          </div>
          <div class="product-details">
            <h3>${product.product_name}</h3>
            <div class="rating">
              <span class="rating-value">${product.rating.score}★</span>
            </div>
            <span class="review-count">${product.rating.total_ratings} & ${product.rating.total_reviews}</span>
            <ul class="specs">
              ${specsList} 
              <li>${product.warranty.phone_warranty || product.warranty.accessories_warranty || ""}</li>
            </ul>
          </div>
          <div class="product-pricing">
            <div class="price-main">
              <span class="current-price">${price.current_price || ""}</span>
              ${
                (price.current_price &&
                  parseInt(price.current_price.replace(/[^\d]/g, "")) > 500)
                  ? '<span class="assured"><img src="./images/fa_9e47c1.png" alt="F-Assured"></span>'
                  : ""
              }
            </div>
            <div>
              <span class="old-price">${price.original_price || ""}</span>
              <span class="discount">${price.discount_percentage || ""}</span>
            </div>
            <p class="offer">${mainOffer}</p> 
            <p class="bank-offer">${product.offers?.bank_offer || ""}</p>
          </div>
        </div>
      `;
    }).join("");

    productList.innerHTML = html || "<p>No products found.</p>";
  };
  renderProducts(filteredProducts);

  searchInput?.addEventListener("input", (e) => {
    const query = e.target.value.toLowerCase();
    filteredProducts = products.filter(p =>
      p.product_name.toLowerCase().includes(query)
    );
    applyFilters(); 
  });

  sortLinks.forEach(link => {
    link.addEventListener("click", (e) => {
      e.preventDefault();
      sortLinks.forEach(l => l.classList.remove("active"));
      e.target.classList.add("active");
      
      const type = e.target.textContent.trim();

      if (type.includes("Low")) {
          filteredProducts.sort((a, b) => extractPrice(a) - extractPrice(b));
      } else if (type.includes("High")) {
          filteredProducts.sort((a, b) => extractPrice(b) - extractPrice(a));
      } else if (type.includes("Newest")) {
          filteredProducts.reverse();
      } else {
          applyFilters();
          return; 
      }

      renderProducts(filteredProducts);
    });
  });

  document.addEventListener('DOMContentLoaded', function() {
    const filterHeaders = document.querySelectorAll('.filter-header');

    filterHeaders.forEach(header => {
        header.addEventListener('click', function() {
            const filterGroup = this.closest('.filter-group');
            
            filterGroup.classList.toggle('collapsed');
        });
    });
});
  const allFilters = [
    ...brandCheckboxes,
    ...ramCheckboxes,
    ...storageCheckboxes,
    ...batteryCheckboxes,
    ...screenCheckboxes,
    ...ratingCheckboxes,
    ...primaryCameraCheckboxes,
    ...secondaryCameraCheckboxes
  ];

  allFilters.forEach(chk => chk.addEventListener("change", applyFilters));
  minPriceSelect.addEventListener("change", applyFilters);
  maxPriceSelect.addEventListener("change", applyFilters);
  clearAllBtn.addEventListener("click", clearAllFilters);

  // Apply all fi
  function applyFilters() {
    const selectedBrands = getChecked(brandCheckboxes);
    const selectedRAM = getChecked(ramCheckboxes);
    const selectedStorage = getChecked(storageCheckboxes);
    const selectedBattery = getChecked(batteryCheckboxes);
    const selectedScreen = getChecked(screenCheckboxes);
    const selectedRating = getChecked(ratingCheckboxes);
    const selectedPrimary = getChecked(primaryCameraCheckboxes);
    const selectedSecondary = getChecked(secondaryCameraCheckboxes);
    const minPrice = parseInt(minPriceSelect.value === "min" ? 0 : minPriceSelect.value);
    const maxPrice = parseInt(maxPriceSelect.value.replace(/\D/g, "")) || Infinity;
    const currentSearchQuery = searchInput.value.toLowerCase();

    filteredProducts = products.filter(p => {
      const specs = p.specifications || {};
      const price = extractPrice(p);

      const searchMatch = p.product_name.toLowerCase().includes(currentSearchQuery);

      const brandMatch = matchList(selectedBrands, p.product_name);
      const ramMatch = matchList(selectedRAM, specs.ram);
      const storageMatch = matchList(selectedStorage, specs.rom);
      const batteryMatch = matchList(selectedBattery, specs.battery);
      const screenMatch = matchList(selectedScreen, specs.display);
      const ratingMatch = selectedRating.length ? selectedRating.some(r => p.rating.score >= parseFloat(r)) : true; 
      const primaryMatch = matchList(selectedPrimary, specs.rear_camera);
      const secondaryMatch = matchList(selectedSecondary, specs.front_camera);
      const priceMatch = price >= minPrice && price <= maxPrice;

      return searchMatch && brandMatch && ramMatch && storageMatch && batteryMatch && screenMatch &&
             ratingMatch && primaryMatch && secondaryMatch && priceMatch;
    });

    const activeSortLink = document.querySelector(".sort-link.active");
    if (activeSortLink) {
        const type = activeSortLink.textContent.trim();
        if (type.includes("Low")) {
            filteredProducts.sort((a, b) => extractPrice(a) - extractPrice(b));
        } else if (type.includes("High")) {
            filteredProducts.sort((a, b) => extractPrice(b) - extractPrice(a));
        } else if (type.includes("Newest")) {
            filteredProducts.reverse();
        }
    }

    updateFilterTags([...selectedBrands, ...selectedRAM, ...selectedStorage, ...selectedBattery, ...selectedScreen, ...selectedRating, ...selectedPrimary, ...selectedSecondary]);
    renderProducts(filteredProducts);
  }

  document.addEventListener('DOMContentLoaded', () => {
    const dropdownItems = document.querySelectorAll('.main-categories li.has-dropdown');

    dropdownItems.forEach(item => {
        const menu = item.querySelector('.dropdown-menu');
        
        if (menu) {
            item.addEventListener('mouseover', () => {
                menu.classList.add('visible');
            });

            item.addEventListener('mouseout', () => {
                menu.classList.remove('visible');
            });
        }
    });
});
const filterHeaders = document.querySelectorAll('.filter-group .header-text, .filter-group .s-arrow');

filterHeaders.forEach(header => {

    header.addEventListener('click', function() {
        const filterGroup = header.closest('.filter-group');
        filterGroup.classList.toggle('collapsed');
    });
});
  const matchList = (list, value) =>
    !list.length || list.some(item => value && value.toLowerCase().includes(item.toLowerCase().split(" ")[0]));

  const getChecked = (nodeList) =>
    [...nodeList].filter(c => c.checked).map(c => c.parentElement.textContent.trim());

  function updateFilterTags(selected) {
    const currentClearAllBtn = clearAllBtn.parentNode === filterTagsContainer ? clearAllBtn : null;
    filterTagsContainer.innerHTML = "";
    
    const isPriceFiltered = minPriceSelect.value !== "min" || maxPriceSelect.value !== "30000";
    if (isPriceFiltered) {
        let min = minPriceSelect.value === "min" ? 'Min' : `₹${minPriceSelect.value}`;
        let max = maxPriceSelect.value === "30000" ? '30000+' : `₹${maxPriceSelect.value}`;
        selected.push(`Price: ${min} to ${max}`); 
    }

    clearAllBtn.style.display = selected.length ? "inline-block" : "none";

    if (selected.length === 0) {
      filterTagsContainer.classList.add("hidden");
    } else {
      filterTagsContainer.classList.remove("hidden");
    }

    selected.forEach(item => {
      const tag = document.createElement("div");
      tag.textContent = item;
      tag.style.cssText = `
        background:#d7d7d7;
        color:black;
        padding:4px 8px;
        border-radius:3px;
        font-size:13px;
        display:flex;
        align-items:center;
        gap:5px;
      `;
      const x = document.createElement("span");
      x.textContent = "✕";
      x.style.cssText = "cursor:pointer;font-weight:bold;";
      x.onclick = () => {
        const checkbox = [...allFilters].find(f => f.parentElement.textContent.trim() === item);
        if (checkbox) {
            checkbox.checked = false;
        } 
        
        if (item.includes("Price:")) {
             minPriceSelect.value = "min";
             maxPriceSelect.value = "30000"; 
        }
        
        applyFilters();
      };
      tag.appendChild(x);
      filterTagsContainer.appendChild(tag);
    });
    filterTagsContainer.appendChild(clearAllBtn);
  }

  function clearAllFilters() {
    [...allFilters].forEach(f => (f.checked = false));
    minPriceSelect.value = "min";
    maxPriceSelect.value = "30000";
    searchInput.value = ""; // Clear search bar

    sortLinks.forEach((l, index) => {
        l.classList.remove("active");
        if (index === 0) l.classList.add("active");
    });

    filterTagsContainer.innerHTML = "";
    filterTagsContainer.classList.add("hidden");
    clearAllBtn.style.display = "none";
    
    filteredProducts = [...products]; 
    renderProducts(filteredProducts);
  }
});